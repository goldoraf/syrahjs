(function(){window.Syrah=Ember.Namespace.create({CURRENT_API_REVISION:1})})(),function(){Date.prototype.toISOString||function(){function a(a){var b=String(a);return b.length===1&&(b="0"+b),b}Date.prototype.toISOString=function(){return this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"."+String((this.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"};var b=Date.parse,c=[1,4,5,6,7,10,11];Date.parse=function(a){var d,e,f=0;if(e=/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.exec(a)){for(var g=0,h;h=c[g];++g)e[h]=+e[h]||0;e[2]=(+e[2]||1)-1,e[3]=+e[3]||1,e[8]!=="Z"&&e[9]!==undefined&&(f=e[10]*60+e[11],e[9]==="+"&&(f=0-f)),d=Date.UTC(e[1],e[2],e[3],e[4],e[5]+f,e[6],e[7])}else d=b?b(a):NaN;return d}}()}(),function(){Syrah.Inflector=Ember.Object.extend({}),Syrah.Inflector.reopenClass({pluralRules:{"(fish)$":"$1$2","(x|ch|ss|sh)$":"$1es",series$:"$1series","([^aeiouy]|qu)ies$":"$1y","([^aeiouy]|qu)y$":"$1ies","(?:([^f])fe|([lr])f)$":"$1$2ves",sis$:"ses","([ti])um$":"$1a",person$:"people",man$:"men",child$:"children","(alias|status)$i":"$1es",s$:"s",$:"s"},singularRules:{"(f)ish$i":"$1$2ish","(x|ch|ss)es$":"$1",movies$:"movie",series$:"series","([^aeiouy]|qu)ies$":"$1y","([lr])ves$":"$1f","([^f])ves$":"$1fe","(analy|ba|diagno|parenthe|progno|synop|the)ses$":"$1sis","([ti])a$":"$1um",people$:"person",men$:"man","(alias|status)es$i":"$1",children$:"child",news$:"news",s$:""},getCollectionName:function(a){return Syrah.Inflector.pluralize(Syrah.Inflector.getTypeName(a))},getTypeName:function(a){var b=a.toString().split("."),c=b[b.length-1];return c.underscore()},getTypeNamespace:function(a){return a.toString().split(".")[0]},getFkForType:function(a){return Syrah.Inflector.getTypeName(a)+"_id"},getFkName:function(a){return a.split(".")[0]},guessAssociationType:function(a,b){var c=Syrah.Inflector.getTypeNamespace(b),d=Syrah.Inflector.singularize(a).camelize().ucfirst();return window[c]&&window[c][d]?window[c][d]:undefined},pluralize:function(a){for(var b in Syrah.Inflector.pluralRules){var c=new RegExp(b,"i");if(a.match(c))return a.replace(c,Syrah.Inflector.pluralRules[b])}return a},singularize:function(a){for(var b in Syrah.Inflector.singularRules){var c=new RegExp(b,"i");if(a.match(c))return a.replace(c,Syrah.Inflector.singularRules[b])}return a},ucfirst:function(a){return a.charAt(0).toUpperCase()+a.slice(1)}}),String.prototype.ucfirst=function(){return Syrah.Inflector.ucfirst(this)}}(),function(){Syrah.Model=Ember.Object.extend({id:Ember.computed(function(a,b){var c=this.getPrimaryKey();return arguments.length===2?(this.setDbRef(c,b),b):this.getDbRef(c)}).property()});var a=function(a,b){if(b===Number||b===String||b===Boolean||b===Date||b===Object||b.isModel===!0)b={type:b};Ember.assert("A property's definition must have a type",b.type!==undefined);if(b.type.isModel||typeof b.type=="string")b.isAssociation=!0,b.foreignKey===undefined&&(b.foreignKey=Syrah.Inflector.getFkForType(b.type)),b.observer=function(){if(this.get(a)===null)this.setDbRef(b.foreignKey,null);else{var c=this.get(a).get("id");Ember.none(c)||this.setDbRef(b.foreignKey,c)}};return b.type===Syrah.HasMany&&(Ember.assert("A HasMany must have an itemType",b.itemType!==undefined),b.isAssociation=!0,b.defaultValue=Syrah.HasMany.getComputedProperty(b)),b};Syrah.Model.reopenClass({define:function(b){var c={},d={},e="id";b.hasOwnProperty("primaryKey")&&(e=b.primaryKey,delete b.primaryKey);for(var f in b)if(b.hasOwnProperty(f)){var g=a(f,b[f]);d[f]=g;var h=g.defaultValue||null;c[f]=h}var i=this.extend(c);return i.isModel=!0,i.__metadata__={primaryKey:e,definedProperties:d},i},create:function(a){var b=this._super.apply(this,arguments);b.__dbrefs__={};var c=b.getAssociations();for(var d in c)c[d].observer&&b.addObserver(d,c[d].observer);return b}}),Syrah.Model.reopen({duplicate:function(a){a=a||{};var b=a.duplicateAssociations||[],c=a.includeAssociations||[],d=this.constructor.create({}),e={},f=this.getPrimitiveProperties();f.forEach(function(a){e[a]=this.get(a)},this),d.setProperties(e);var g=function(a,b){var c=[],d=new RegExp("^"+b+".");return a.forEach(function(a){a.match(d)&&c.push(a.replace(d,""))}),c},h=this.getAssociations();for(var i in h){if(b.indexOf(i)===-1&&c.indexOf(i)===-1)continue;var j=h[i],k={duplicateAssociations:g(b,i),includeAssociations:g(c,i)};j.type===Syrah.HasMany?this.get(i).forEach(function(a){b.indexOf(i)!==-1?d.get(i).pushObject(a.duplicate(k)):c.indexOf(i)!==-1&&d.get(i).pushObject(a)}):b.indexOf(i)!==-1?d.set(i,this.get(i).duplicate(k)):c.indexOf(i)!==-1&&d.set(i,this.get(i))}return d},isNew:function(){return this.get("id")===undefined},getPrimaryKey:function(){return this.getMetadata().primaryKey},setDbRef:function(a,b){this.__dbrefs__[a]=b},getDbRef:function(a){return this.__dbrefs__[a]},getDbRefsPossibleKeys:function(){return[this.getPrimaryKey()]},getAssociations:function(){var a={},b=this.getMetadata().definedProperties;for(var c in b)b[c].isAssociation&&(a[c]=b[c]);return a},getPropertyType:function(a){return this.getPropertyDefinition(a).type},getPropertyDefault:function(a){return this.getPropertyDefinition(a).defaultValue},getPropertyDefinition:function(a){return Ember.assert("Property '"+a+"' has not been defined",this.getMetadata().definedProperties.hasOwnProperty(a)),this.getMetadata().definedProperties[a]},getPrimitiveProperties:function(){return this.getDefinedProperties().filter(function(a){return!this.getPropertyDefinition(a).isAssociation},this)},getDefinedProperties:function(){return Ember.keys(this.getMetadata().definedProperties)},getMetadata:function(){return this.constructor.__metadata__}}),Syrah.Model.reopenClass({getPk:function(){return this.__metadata__.primaryKey}}),Syrah.HasMany=Ember.Object.extend({}),Syrah.HasMany.getComputedProperty=function(a){var b=a.foreignKey||null;return Ember.computed(function(c,d){return Syrah.HasManyCollection.create({type:a.type,content:[],parentObject:this,foreignKey:b})}).property().cacheable()},Syrah.ModelCollection=Ember.ArrayProxy.extend({type:null,content:[]}),Syrah.HasManyCollection=Syrah.ModelCollection.extend({parentObject:null,foreignKey:null,pushObject:function(a){var b=this.get("foreignKey");b===null&&(b=Syrah.Inflector.getFkForType(this.get("parentObject").constructor));var c=this.get("parentObject").get("id");if(!Ember.none(c)){var d=Syrah.Inflector.getFkName(b);a.setDbRef(b,c),a.set(d,this.get("parentObject"))}this._super(a)}}),Syrah.typecastFor=function(a){switch(a){case Date:return Syrah.typecasts.date;default:return undefined}},Syrah.typecasts={date:{fromJson:function(a){return typeof a=="string"||typeof a=="number"?new Date(Date.parse(a)):null},toJson:function(a){return a instanceof Date?a.toISOString():a}}}}(),function(){Syrah.JSONMarshaller=Ember.Object.extend({marshall:function(a,b){var b=b||{};return a instanceof Syrah.Model?this.marshallModel(a,b.embedded):this.marshallSimpleObject(a)},unmarshall:function(a,b){return b instanceof Syrah.Model?this.unmarshallModel(a,b):this.unmarshallSimpleObject(a,b)},marshallModel:function(a,b){var c=a.getPrimitiveProperties(),d=b||[],e=a.getProperties(c),f=a.getMetadata().definedProperties;for(var g in e){var h=f[g].type,i=Syrah.typecastFor(h);i!==undefined&&(e[g]=i.toJson(e[g]))}var j=function(a){var b=[],c=new RegExp("^"+a+".");return d.forEach(function(a){a.match(c)&&b.push(a.replace(c,""))}),b},k=a.getAssociations();for(var l in k){if(d.indexOf(l)===-1)continue;var m=f[l];if(m.type===Syrah.HasMany){var n=[];a.get(l).get("content").forEach(function(a){n.push(this.marshallModel(a,j(l)))},this),e[l]=n}else e[l]=this.marshallModel(a.get(l),j(l))}for(var o in a.__dbrefs__)e[o]=a.__dbrefs__[o];return e},unmarshallModel:function(a,b){var c=b.getMetadata().definedProperties,d=b.getDbRefsPossibleKeys(),e={};b.beginPropertyChanges();for(var f in a){var g=a[f];d.indexOf(f)!==-1&&b.setDbRef(f,g);if(!c.hasOwnProperty(f))continue;var h=c[f];if(h.isAssociation===!0){if(h.type===Syrah.HasMany&&g instanceof Array){var i=Ember.typeOf(h.itemType)==="string"?Ember.getPath(h.itemType):h.itemType;g.forEach(function(a){b.get(f).pushObject(this.unmarshallModel(a,i.create()))},this)}else if(g instanceof Object){var i=Ember.typeOf(h.type)==="string"?Ember.getPath(h.type):h.type;b.set(f,this.unmarshallModel(g,i.create()))}}else{var j=Syrah.typecastFor(h.type);j!==undefined&&(g=j.fromJson(g)),e[f]=g}}return b.setProperties(e),b.endPropertyChanges(),b},marshallSimpleObject:function(a){var b,c=[];for(var d in a)if(a.hasOwnProperty(d)){b=a[d];if(b==="toString")continue;if(Ember.typeOf(b)==="function")continue;c.push(d)}var e=a.getProperties(c);return e},unmarshallSimpleObject:function(a,b){var c={};for(var d in a){v=a[d];if(v instanceof Array){c[d]=Ember.A([]);var e=Syrah.Inflector.guessAssociationType(d,b.constructor);e===undefined&&(e=Ember.Object),v.forEach(function(a){c[d].push(this.unmarshall(a,e.create()))},this)}else c[d]=v}return b.beginPropertyChanges(),b.setProperties(c),b.endPropertyChanges(),b}})}(),function(){Syrah.Bulk=Ember.Object.extend({store:null,created:null,updated:null,deleted:null,init:function(){this._super(),this.emptyBuckets()},save:function(a){a.isNew()?this.pushObjectInBucket("created",a):this.pushObjectInBucket("updated",a)},destroy:function(a){this.pushObjectInBucket("deleted",a)},commit:function(a){this.commitCreated(a),this.commitUpdated(a),this.commitDeleted(a),this.emptyBuckets()},commitCreated:function(a){var b=this.get("store"),c=this.get("created");for(var d in c){var e=[];c[d].forEach(function(a){e.pushObject(b.toJSON(a))});var f=this.prepareCallbacks(b.didAddObjects,c[d],a);b.ds.addInBulk(Ember.getPath(d),e,f[0],f[1])}},commitUpdated:function(a){var b=this.get("store"),c=this.get("updated");for(var d in c){var e=[];c[d].forEach(function(a){e.pushObject(b.toJSON(a))});var f=this.prepareCallbacks(b.didUpdateObjects,c[d],a);b.ds.updateInBulk(Ember.getPath(d),e,f[0],f[1])}},commitDeleted:function(a){var b=this.get("store"),c=this.get("deleted");for(var d in c){var e=[];c[d].forEach(function(a){e.push(a.get("id"))});var f=this.prepareCallbacks(b.didDestroyObjects,c[d],a);b.ds.destroyInBulk(Ember.getPath(d),e,f[0],f[1])}},pushObjectInBucket:function(a,b){var c=this.get(a),d=b.constructor;c.hasOwnProperty(d)||(c[d]=[]),c[d].pushObject(b)},prepareCallbacks:function(a,b,c){var d=this.get("store"),e=d.prepareCallbacks([a,d,b],c,"success"),f=d.prepareCallbacks([d.didError,d,b],c,"error");return[e,f]},emptyBuckets:function(){this.set("created",{}),this.set("updated",{}),this.set("deleted",{})}})}(),function(){Syrah.Store=Ember.Object.extend({ds:null,marshaller:Syrah.JSONMarshaller.create(),save:function(a,b){return a.isNew()?this.add(a,b):this.update(a,b)},add:function(a,b){b=b||{};var c=b.embedded||[],d=this.prepareCallbacks([this.didAddObject,this,a,c],b,"success"),e=this.prepareCallbacks([this.didError,this,a],b,"error");return this.get("ds").add(a.constructor,this.toJSON(a,b),d,e),a},update:function(a,b){b=b||{};var c=this.prepareCallbacks([this.didUpdateObject,this,a],b,"success"),d=this.prepareCallbacks([this.didError,this,a],b,"error");return this.get("ds").update(a.constructor,this.toJSON(a,b),c,d),a},destroy:function(a,b){b=b||{};var c=this.prepareCallbacks([this.didDestroyObject,this,a],b,"success"),d=this.prepareCallbacks([this.didError,this,a],b,"error");this.get("ds").destroy(a.constructor,this.toJSON(a,b),c,d);return},find:function(a,b){if(b===undefined)return this.all(a);var c=Ember.A([]);return this.get("ds").find(a,c,b,this.loadMany,this),c},findById:function(a,b){var c=a.create();return this.get("ds").findById(a,c,b,this.load,this),c},all:function(a){var b=Ember.A([]);return this.get("ds").all(a,b,this.loadMany,this),b},bulk:function(){return Syrah.Bulk.create({store:this})},loadMany:function(a,b,c){var d=[];return c.forEach(function(b){d.push(this.load(a.create(),b))},this),b.pushObjects(d),b},load:function(a,b){return this.get("marshaller").unmarshall(b,a)},didAddObject:function(a,b,c){var d=a.hasOwnProperty("getPrimaryKey")?a.getPrimaryKey():"id";if(c[d]===undefined)throw"The DataSource has not provided an ID for the newly created object";return id=c[d],a.set("id",id),b.length!==0&&this.didAddEmbeddedObjects(a,b,c),a},didAddEmbeddedObjects:function(a,b,c){var d=a.getAssociations(),e=a.getMetadata().definedProperties,f=function(a){var c=[],d=new RegExp("^"+a+".");return b.forEach(function(a){a.match(d)&&c.push(a.replace(d,""))}),c};for(var g in d){if(b.indexOf(g)===-1)continue;if(c[g]===undefined)throw"The DataSource has not provided a JSON value (with IDs) for the newly created '"+g+"' embedded object(s)";var h=e[g];h.type===Syrah.HasMany?a.get(g).get("content").forEach(function(a,b){this.didAddObject(a,f(g),c[g][b])},this):this.didAddObject(item,f(g),c[g])}},didUpdateObject:function(a,b){},didDestroyObject:function(a){a.destroy()},didAddObjects:function(a,b){b.forEach(function(b,c){this.didAddObject(a[c],[],b)},this)},didUpdateObjects:function(a,b){},didDestroyObjects:function(a){a.forEach(function(a){this.didDestroyObject(a)},this)},didError:function(a,b){},toJSON:function(a,b){return this.get("marshaller").marshall(a,b)},prepareCallbacks:function(a,b,c){b=b||{};var d=[];return d.push(a),b[c]!==undefined&&b[c]instanceof Array&&d.push(b[c]),d}})}(),function(){Syrah.DataSource=Ember.Object.extend({all:null,find:null,findById:null,add:null,executeCallbacks:function(a){var b=arguments;a.forEach(function(a){var c=a.shift(),d=a.shift();for(var e=1;e<b.length;e++)a.push(b[e]);c.apply(d,a)},this)},getCollectionName:function(a){return Syrah.Inflector.getCollectionName(a)}})}(),function(){Syrah.RESTApiDataSource=Syrah.DataSource.extend({baseUrl:"",urlEncodeData:!1,all:function(a,b,c,d){this.ajax(a,this.buildUrl(a),"GET",{success:function(e){c.call(d,a,b,e)}})},find:function(a,b,c,d,e){this.ajax(a,this.buildUrl(a),"GET",{data:c,success:function(c){d.call(e,a,b,c)}})},findById:function(a,b,c,d,e){this.ajax(a,this.buildUrl(a)+"/"+c,"GET",{success:function(a){d.call(e,b,a)}})},add:function(a,b,c,d){this.ajax(a,this.buildUrl(a),"POST",{data:this.encodePayload(a,b)},c,d)},addInBulk:function(a,b,c,d){this.ajax(a,this.buildUrl(a)+"/bulk","POST",{data:this.encodeBulkPayload(a,b)},c,d)},update:function(a,b,c,d){var e=b[a.getPk()];this.ajax(a,this.buildUrl(a)+"/"+e,"PUT",{data:this.encodePayload(a,b)},c,d)},updateInBulk:function(a,b,c,d){this.ajax(a,this.buildUrl(a)+"/bulk","PUT",{data:this.encodeBulkPayload(a,b)},c,d)},destroy:function(a,b,c,d){var e=b[a.getPk()];this.ajax(a,this.buildUrl(a)+"/"+e,"DELETE",{},c,d)},destroyInBulk:function(a,b,c,d){this.ajax(a,this.buildUrl(a)+"/bulk","DELETE",{data:this.encodeBulkPayload(a,b)},c,d)},ajax:function(a,b,c,d,e,f){d.url=b,d.type=c,d.dataType="json",d.contentType=this.get("urlEncodeData")===!1?"application/json; charset=utf-8":"application/x-www-form-urlencoded; charset=UTF-8",d.context=this,d.data&&d.type!=="GET"&&this.get("urlEncodeData")===!1&&(d.data=JSON.stringify(d.data)),d.success===undefined&&e!==undefined&&(d.success=function(b,c,d){this.isRequestSuccessful(b,c,d)?this.executeCallbacks(e,this.parseResponseData(b,a)):this.executeCallbacks(f,{},this.parseErrorResponse(d.responseText),d)}),d.error===undefined&&f!==undefined&&(d.error=function(a,b,c){this.executeCallbacks(f,c,this.parseErrorResponse(a.responseText),a)}),jQuery.ajax(d)},buildPayload:function(a,b){if(this.get("urlEncodeData")!==!1){var c=a.toJSON(b),d=[],e=Syrah.Inflector.getTypeName(b.constructor);for(var f in c){var g=c[f]===null?"":encodeURIComponent(c[f]);d.push(e+"."+f+"="+g)}return d.join("&")}return a.toJSON(b)},encodePayload:function(a,b,c,d){if(this.get("urlEncodeData")!==!1){var e=[];d!==undefined?d+=".":d="",d+=Syrah.Inflector.getTypeName(a),c!==undefined&&(d+="["+c+"]");for(var f in b)if(Ember.typeOf(b[f])==="array")e.push(this.encodeBulkPayload(f,b[f],d));else if(Ember.typeOf(b[f])==="object")e.push(this.encodePayload(f,b[f],undefined,d));else{var g=b[f]===null?"":encodeURIComponent(b[f]);e.push(d+"."+f+"="+g)}return e.join("&")}return b},encodeBulkPayload:function(a,b,c){if(this.get("urlEncodeData")!==!1){var d=[];return b.forEach(function(b,e){Ember.typeOf(b)!=="instance"&&Ember.typeOf(b)!=="object"?d.push(a.getPk()+"["+e+"]="+b):c!==undefined?d.push(this.encodePayload(a,b,e,c)):d.push(this.encodePayload(a,b,e))},this),d.join("&")}return b},buildUrl:function(a){return this.get("baseUrl")+"/"+this.getCollectionName(a)},isRequestSuccessful:function(a,b,c){return!0},parseResponseData:function(a,b){return a},parseErrorResponse:function(a){return JSON.parse(a)}})}(),function(){function a(){return((1+Math.random())*65536|0).toString(16).substring(1)}function b(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}Syrah.LocalStorageDataSource=Syrah.DataSource.extend({name:null,storage:localStorage,all:function(a,b,c,d){var e=this.getCollectionName(a),f=this.fetchMany(e,this.keys(e));return c.call(d,a,b,f),b},findById:function(a,b,c,d,e){var f=this.getCollectionName(a),g=this.fetch(f,c);return d.call(e,b,g),b},fetch:function(a,b){var c=this.get("storage").getItem(this.get("name")+":"+a+":"+b);return JSON.parse(c)},fetchMany:function(a,b){var c=[];return b.forEach(function(b){c.push(this.fetch(a,b))},this),c},add:function(a,c,d,e){var f=this.getCollectionName(a),g=this.keys(f),h=b();g.push(h),this.persistKeys(f,g),this.persistObject(f,h,c),c.id=h,this.executeCallbacks(d,c)},update:function(a,b,c,d){var e=this.getCollectionName(a),f=b[a.getPk()];this.persistObject(e,f,b),this.executeCallbacks(c,b)},destroy:function(a,b,c,d){var e=this.getCollectionName(a),f=this.keys(e),g=b[a.getPk()];f.removeAt(f.indexOf(g)),this.persistKeys(e,f),this.get("storage").removeItem(this.get("name")+":"+e+":"+g),this.executeCallbacks(c,b)},persistObject:function(a,b,c){this.get("storage").setItem(this.get("name")+":"+a+":"+b,JSON.stringify(c))},keys:function(a){return this.get("storage").getItem(this.get("name")+":"+a).split(",")},persistKeys:function(a,b){this.get("storage").setItem(this.get("name")+":"+a,b.join(","))}})}(),function(){}()